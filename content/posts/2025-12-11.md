+++
date = "2025-12-11 08:00:00"
draft = true
title = "fanbox-dlを試す"
description = "ここのブログの手コピーも疲れる。とくに画像がめんどくさい。curlで取得しても、ブログの本体は取れずにダイジェストのようなものしか取得できない。"

[taxonomies]
tags = ["blog", "fanbox"]

[extra]
image = "/compute.jpg"
+++

　ここのブログの手コピーも疲れる。とくに画像がめんどくさい。  
　curlで取得しても、ブログの本体は取れずにダイジェストのようなものしか取得できない。

　どう、Cloudflare 側の保護が強くなり、Captchaや403で止まるとか、CookieがIP等に紐づいて別環境だと弾かれるとかがあるらしい。

　OSSのPython実装で実績のある実装を調べる。こんな感じかな。

> lkmcfj/pixiv-fanbox-download: A python script to download pixiv fanbox images which you already have access to  
> <https://github.com/lkmcfj/pixiv-fanbox-download?utm_source=chatgpt.com>

> hareku/fanbox-dl: Pixiv Fanbox Downloader  
> <https://github.com/hareku/fanbox-dl>

> Ristellise/garnet: A Reasonably fast pixiv fanbox.cc downloader and indexer  
> <https://github.com/Ristellise/garnet/>

　fanbox-dlが一番活発のようだ。リリースには、macOS用のバイナリもある。

![](/2025-12-11/7m8IfC0Qi6Dn0bpMjqthF7SZ.png)

　fanbox-dl_Darwin_arm64.tar.gzをダウンロードして展開する。

![](/2025-12-11/glLqxxAp9XE9KkA2IbuY6w5s.png)

　fanbox-dlは投稿URLを1本渡して、その投稿だけを落とす用途というより、--creatorで指定してクリエイター単位でメディアをダウンロードする作りになっている。膨大なんだけど、大丈夫かしらん？

　まずは、ログインすると登録されるCookieのFANBOXSESSIDを取得する。  
　ブラウザでfanboxにログインした状態で、開発者ツールから探す。

![](/2025-12-11/5PofRdy90rkx8TqSl9eAIqd2.png)

　作業用ディレクトリを作る。コマンドのディレクトリもその下に入れておく。

```
% mkdir -p download_fanbox/content
% cd download_fanbox
% mv ~/Downloads/fanbox-dl_Darwin_arm64/ ./
% chmod +x ./fanbox-dl_Darwin_arm64/fanbox-dl
```

　オプションはこんな感じ。  
　creatornameはkinnekoだよな。  
　dir-by-planをつけておくと、投稿のタイトルに基づいて、保存されたコンテンツをディレクトリに分割する。フラグが付いている場合は、プランディレクトリ内に保存される。

```
% ./fanbox-dl --sessid [FANBOXSESSID] --creator kinneko --save-dir ./content --dir-by-post
```

　実行してみる。権限チェックが出た。

![](/2025-12-11/Gya2AJAHcDgIZ41NfV79jEAc.png)

　プロセスがkillされちゃったw

```
zsh: killed     ./fanbox-dl_Darwin_arm64/fanbox-dl --sessid  --creator kinneko --save-dir
```

　quarantine(隔離)属性がついている。

```
% xattr -l ./fanbox-dl_Darwin_arm64/fanbox-dl
com.apple.quarantine: 0081;692e7ece;Firefox;AD7E6CC4-887D-472E-B4F9-6AF8D3053354
```

　外す。

```
% xattr -d com.apple.quarantine ./fanbox-dl_Darwin_arm64/fanbox-dl
```

　何もでなくなった。

```
% xattr -l ./fanbox-dl_Darwin_arm64/fanbox-dl
```

　再実行。でもまたエラー。

```
dyld: Symbol not found: _SecTrustCopyCertificateChain
  Referenced from: /Users/kinneko/Downloads/download_fanbox/./fanbox-dl_Darwin_arm64/fanbox-dl (which was built for Mac OS X 12.0)
  Expected in: /System/Library/Frameworks/Security.framework/Versions/A/Security
 in /Users/kinneko/Downloads/download_fanbox/./fanbox-dl_Darwin_arm64/fanbox-dl
zsh: abort      ./fanbox-dl_Darwin_arm64/fanbox-dl --sessid  --creator kinneko --save-dir
```

　あいたた。Goの実行環境(Go 1.25)の都合で、macOS 12.0向けにビルドされていて、それより古いmacOSだと Security.framework に存在しないシンボル（_SecTrustCopyCertificateChain）を呼びに行って落ちている。確かにこの環境は11だもんな。

　 v0.27.4は動きそうだ。でも、fixに対応できてないから、落とせるかどうかはわからないね。  
　しょうがないので、ダウングレード。  
　結果は、403エラーだな。やっぱダメか。

```
time=2025-12-02T15:17:34.310+09:00 level=INFO msg="Launching Pixiv FANBOX Downloader!" version=0.27.4 commit=02a3e76648c143dde76e9725c58bd81fc5ad4281 date=2025-06-30T11:25:40Z
time=2025-12-02T15:17:34.310+09:00 level=INFO msg="Start downloading" creator_id=kinneko
time=2025-12-02T15:17:34.783+09:00 level=ERROR msg="fanbox-dl Error" error="failed downloading of \"kinneko\": handle page: handle post: get post: status is 403 Forbidden"
time=2025-12-02T15:17:34.783+09:00 level=ERROR msg="The error log seems a bug, please open an issue on GitHub" url=https://github.com/hareku/fanbox-dl/issues
```

　Linux環境でやる？ しょうがないのでUbuntuの仮想マシンを用意した。

```
kinneko@ubuntu:~$ curl -OL https://github.com/hareku/fanbox-dl/releases/download/v0.28.1/fanbox-dl_Linux_arm64.tar.gz
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100 5039k  100 5039k    0     0  3925k      0  0:00:01  0:00:01 --:--:-- 3925k
kinneko@ubuntu:~$ tar xfp fanbox-dl_Linux_arm64.tar.gz
kinneko@ubuntu:~$ chmod +x fanbox-dl
```

　実行する。動いた...

```
kinneko@ubuntu:~$ ./fanbox-dl --sessid $FANBOXSESSID --creator kinneko --save-dir ./content --dir-by-post
time=2025-12-02T07:00:51.160Z level=INFO msg="Launching Pixiv FANBOX Downloader!" version=0.28.1 commit=170a77e3feefd925a8e5f9fd22137b0194e6558b date=2025-11-09T13:29:44Z
time=2025-12-02T07:00:51.160Z level=INFO msg="Start downloading" creator_id=kinneko
time=2025-12-02T07:00:51.452Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -3-" published_at=2025-12-02T08:00:00+09:00 i=0 asset_type=image
time=2025-12-02T07:00:51.748Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -3-" published_at=2025-12-02T08:00:00+09:00 i=1 asset_type=image
time=2025-12-02T07:00:53.071Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -3-" published_at=2025-12-02T08:00:00+09:00 i=2 asset_type=image
time=2025-12-02T07:00:53.192Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -3-" published_at=2025-12-02T08:00:00+09:00 i=3 asset_type=image
time=2025-12-02T07:00:53.786Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -3-" published_at=2025-12-02T08:00:00+09:00 i=4 asset_type=image
time=2025-12-02T07:00:53.941Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -2-" published_at=2025-12-01T08:00:00+09:00 i=0 asset_type=image
time=2025-12-02T07:00:54.027Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -2-" published_at=2025-12-01T08:00:00+09:00 i=1 asset_type=image
time=2025-12-02T07:00:54.129Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -2-" published_at=2025-12-01T08:00:00+09:00 i=2 asset_type=image
time=2025-12-02T07:00:54.316Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -2-" published_at=2025-12-01T08:00:00+09:00 i=3 asset_type=image
time=2025-12-02T07:00:54.394Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -2-" published_at=2025-12-01T08:00:00+09:00 i=4 asset_type=image
time=2025-12-02T07:00:55.065Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -2-" published_at=2025-12-01T08:00:00+09:00 i=5 asset_type=image
time=2025-12-02T07:00:55.229Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -2-" published_at=2025-12-01T08:00:00+09:00 i=6 asset_type=image
time=2025-12-02T07:00:55.378Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -1-" published_at=2025-11-28T08:00:00+09:00 i=0 asset_type=image
time=2025-12-02T07:00:55.468Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -1-" published_at=2025-11-28T08:00:00+09:00 i=1 asset_type=image
time=2025-12-02T07:00:55.557Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -1-" published_at=2025-11-28T08:00:00+09:00 i=2 asset_type=image
time=2025-12-02T07:00:56.327Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -1-" published_at=2025-11-28T08:00:00+09:00 i=3 asset_type=image
time=2025-12-02T07:00:56.439Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -1-" published_at=2025-11-28T08:00:00+09:00 i=4 asset_type=image
time=2025-12-02T07:00:56.540Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -1-" published_at=2025-11-28T08:00:00+09:00 i=5 asset_type=image
time=2025-12-02T07:00:56.623Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -1-" published_at=2025-11-28T08:00:00+09:00 i=6 asset_type=image
time=2025-12-02T07:00:56.715Z level=INFO msg=Downloading creator_id=kinneko title="Zola使ってみる -1-" published_at=2025-11-28T08:00:00+09:00 i=7 asset_type=image
time=2025-12-02T07:00:56.868Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=0 asset_type=image
time=2025-12-02T07:00:56.969Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=1 asset_type=image
time=2025-12-02T07:00:57.137Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=2 asset_type=image
time=2025-12-02T07:00:57.336Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=3 asset_type=image
time=2025-12-02T07:00:57.513Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=4 asset_type=image
time=2025-12-02T07:00:57.703Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=5 asset_type=image
time=2025-12-02T07:00:57.869Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=6 asset_type=image
time=2025-12-02T07:00:58.041Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=7 asset_type=image
time=2025-12-02T07:00:58.187Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=8 asset_type=image
time=2025-12-02T07:00:58.351Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=9 asset_type=image
time=2025-12-02T07:00:58.520Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=10 asset_type=image
time=2025-12-02T07:00:58.687Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=11 asset_type=image
time=2025-12-02T07:00:58.874Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -2-" published_at=2025-11-27T08:00:00+09:00 i=12 asset_type=image
time=2025-12-02T07:00:59.019Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -1-" published_at=2025-11-26T08:00:00+09:00 i=0 asset_type=image
time=2025-12-02T07:00:59.124Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -1-" published_at=2025-11-26T08:00:00+09:00 i=1 asset_type=image
time=2025-12-02T07:00:59.302Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -1-" published_at=2025-11-26T08:00:00+09:00 i=2 asset_type=image
time=2025-12-02T07:00:59.496Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -1-" published_at=2025-11-26T08:00:00+09:00 i=3 asset_type=image
time=2025-12-02T07:00:59.695Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -1-" published_at=2025-11-26T08:00:00+09:00 i=4 asset_type=image
time=2025-12-02T07:00:59.871Z level=INFO msg=Downloading creator_id=kinneko title="PortABCとExtPortForATOM -1-" published_at=2025-11-26T08:00:00+09:00 i=5 asset_type=image
(snip)
```

　すげー落ちてくる。マジでぜんぶ取得するモードだわ... コワ...

　こんな感じで落ちてくる。

```
kinneko@ubuntu:~$ ls content/kinneko/
'2025-02-24-M5Stack Unit ASR買った'
 2025-02-25-メイカーズながおかまつりで展示してきます
'2025-02-26-#ENCOUNTERS2025 で犬ロボ見てきた -1-'
'2025-02-27-#ENCOUNTERS2025 で犬ロボ見てきた -2-'
 2025-03-02-メイカーズながおかまつりで展示できませんでした
'2025-03-03-#M5StackLLM セッションをローカル実行する -2-'
'2025-03-04-#M5StackLLM セッションをローカル実行する -3-'
(snip)
```

　ディレクトリを見る。えっと、画像しか落ちてませんね...

```
kinneko@ubuntu:~$ ls content/kinneko/'2025-02-24-M5Stack Unit ASR買った'
0-0g0B02oscZInEAKmSmg3mwx7.png  5-uayhDDtxkLiKIUwlS3EM2L83.png
1-FTAiBKLcjzprOENG0RLwzMSW.png  6-ZzaBMWoORW1WEW4mY5tL0y5s.png
2-ouEK7ntKNHrYXXSGi2MvAQp2.png  7-WzByLgKerou0CAETFON4huBM.png
3-rfFpDr74Fd5hJz0i2LLTKMm1.png  8-VEqJ9ikFci8i6LnqDBV1rKyd.png
4-RPYfl3YcEccFOxH4tkLJdTox.png  9-GYr2hATBNMmof4eKn6jXlTyi.png
```

　そして実行が中断した。

```
time=2025-12-02T07:05:47.832Z level=INFO msg=Downloading creator_id=kinneko title="M5stack LLM Module買う -3-" published_at=2024-12-27T08:00:00+09:00 i=0 asset_type=image
time=2025-12-02T07:05:47.946Z level=ERROR msg="fanbox-dl Error" error="failed downloading of \"kinneko\": handle page: handle post: handle image: download: download error: save a file: file copying error: http2: server sent GOAWAY and closed the connection; LastStreamID=1999, ErrCode=NO_ERROR, debug=\"\""
time=2025-12-02T07:05:47.946Z level=ERROR msg="The error log seems a bug, please open an issue on GitHub" url=https://github.com/hareku/fanbox-dl/issues
```

　再実行しても、ダウンロード終わってるって言われる。件数固定だろうか？

```
kinneko@ubuntu:~$ ./fanbox-dl --sessid $FANBOXSESSID --creator kinneko --save-dir ./content --dir-by-post
time=2025-12-02T07:08:41.513Z level=INFO msg="Launching Pixiv FANBOX Downloader!" version=0.28.1 commit=170a77e3feefd925a8e5f9fd22137b0194e6558b date=2025-11-09T13:29:44Z
time=2025-12-02T07:08:41.517Z level=INFO msg="Start downloading" creator_id=kinneko
time=2025-12-02T07:08:41.832Z level=INFO msg=Completed. duration=300ms
```

　なるほど、--allつけないと全件にならないってことね。

　でも、画像しか落とさないのじゃ、目的の用途と違うなぁ...

　fanbox-dlは、絵の収集目的のツールだった。
　残念無念。

---
> オリジナル投稿：
> fanbox-dlを試す｜kinneko｜pixivFANBOX  
> <https://www.fanbox.cc/@kinneko/posts/10979641>

